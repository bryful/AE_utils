(function (me){	if ( app.preferences.getPrefAsLong("Main Pref Section", "Pref_SCRIPTING_FILE_NETWORK_SECURITY") != 1){		var s = "すみません。以下の設定がオフになっています。\r\n\r\n";		s +=  "「環境設定：一般設定：スクリプトによるファイルへの書き込みとネットワークへのアクセスを許可」\r\n";		s += "\r\n";		s += "このスクリプトを使う為にはオンにする必要が有ります。\r\n";		alert(s);		return;	}	function getFileNameWithoutExt(s)	{		var ret = s;		var idx = ret.lastIndexOf(".");		if ( idx>=0){			ret = ret.substring(0,idx);		}		return ret;	}	function getScriptName()	{		var ary = $.fileName.split("/");		return File.decode( getFileNameWithoutExt(ary[ary.length-1]));	}	function getScriptPath()	{		var s = $.fileName;		return s.substring(0,s.lastIndexOf("/"));	}	var scriptName = getScriptName();	var targetComp = null;	var count = 0;//*************************//MainWindowvar winObj = ( me instanceof Panel) ? me : new Window("palette", scriptName, [0,0,0+220,0+280]  ,{resizeable:true, maximizeButton:true, minimizeButton:true});
//*************************//controlsvar yp = 10;var lbCaption = winObj.add("statictext",[10, yp, 10+420, yp+20],"エクスプレッションの置換");yp+=25;var lbCaption2 = winObj.add("statictext",[10, yp, 10+420, yp+20],"アイカツ用コンポ内全部対象");yp+=30;var btnGetComp = winObj.add("button",[10, yp, 10+200, yp+25],"コンポを指定");yp+=30;var edComp = winObj.add("edittext",[10, yp, 10+200, yp+20],"未指定",{readonly:true});yp+=30;var lbSrc = winObj.add("statictext",[10, yp, 10+400, yp+20],"置換元");yp+=25;var edSrc = winObj.add("edittext",[10, yp, 10+200, yp+20],"S1");yp+=30;var lbDst = winObj.add("statictext",[10, yp, 10+400, yp+20],"置換元");yp+=25;var edDst = winObj.add("edittext",[10, yp, 10+200, yp+20],"S2");yp+=35;var btnExec = winObj.add("button",[10, yp, 10+200, yp+25],"実行");//*************************var getComp = function(){	targetComp = null;	edComp.text = "未指定";		var sel = app.project.selection;	if ( app.project.selection.length !== 1) {		alert("1個だけ選択してください");		return targetComp;	}	var ac = app.project.selection[0];	if ( (ac instanceof CompItem)===false)	{		alert("コンポを選択してください");		return targetComp;	}	targetComp = ac;	edComp.text = targetComp.name;	return targetComp;}btnGetComp.onClick = getComp;//*************************var replaceExp = function(prop,src,dst){	if ( (prop instanceof Property) === false)	{		return false ;	}	if (prop.canSetExpression === false) return false;	if (prop.expression==="") return false;	var s = prop.expression;	var d  = s.split(src).join(dst);	if (s !== d) {		prop.selected = true;		prop.expression = d;		count++;	}	return true;}//*************************var replaceExpPropertyGroup = function(pg,src,dst){	if ((pg instanceof PropertyGroup)==false) {		return;	}	if (pg.numProperties <=0) {		return;	}	for ( var i=1; i<=pg.numProperties; i++)	{		var p = pg.property(i);		if ( p instanceof PropertyGroup)		{			replaceExpPropertyGroup(p,src,dst);		}else if ( p instanceof Property)		{			replaceExp(p,src,dst);		}	}}//*************************var replaceExpLayer = function(lyr,src,dst){	var ret = false;	var p1 = lyr.property("ADBE Transform Group");	var p2 = lyr.property("ADBE Effect Parade");		replaceExpPropertyGroup(p1,src,dst);	replaceExpPropertyGroup(p2,src,dst);	ret = true;	return ret;}//*************************var exec = function(){		if (( targetComp ===null)||((targetComp instanceof CompItem)===false))	{		alert("コンポが選択されていません");		return;	}			var src = edSrc.text;
	var dst = edDst.text;	if (src=="") return;
	if (src == dst) return;	app.beginUndoGroup(scriptName);	count=0;	var lc = targetComp.numLayers;	if (lc>0)	{		for ( var i=1; i<=lc; i++)		{			var lyr = targetComp.layer(i);			replaceExpLayer(lyr,src,dst);		}	}	app.endUndoGroup();	alert(count+"箇所のエクスプレッションを変更しました");}btnExec.onClick = exec;//*************************//window show	if ( ( me instanceof Panel) == false){
		winObj.center(); 
		winObj.show();
	}})(this);