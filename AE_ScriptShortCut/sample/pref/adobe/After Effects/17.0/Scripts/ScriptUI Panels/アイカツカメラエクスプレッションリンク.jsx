(function (me){	if ( app.preferences.getPrefAsLong("Main Pref Section", "Pref_SCRIPTING_FILE_NETWORK_SECURITY") != 1){		var s = "すみません。以下の設定がオフになっています。\r\n\r\n";		s +=  "「環境設定：一般設定：スクリプトによるファイルへの書き込みとネットワークへのアクセスを許可」\r\n";		s += "\r\n";		s += "このスクリプトを使う為にはオンにする必要が有ります。\r\n";		alert(s);		return;	}	function getFileNameWithoutExt(s)	{		var ret = s;		var idx = ret.lastIndexOf(".");		if ( idx>=0){			ret = ret.substring(0,idx);		}		return ret;	}	function getScriptName()	{		var ary = $.fileName.split("/");		return File.decode( getFileNameWithoutExt(ary[ary.length-1]));	}	function getScriptPath()	{		var s = $.fileName;		return s.substring(0,s.lastIndexOf("/"));	}	var scriptName = getScriptName();//*************************//MainWindowvar winObj = ( me instanceof Panel) ? me : new Window("palette", scriptName, [0,0,0+220,0+95]  ,{resizeable:true, maximizeButton:true, minimizeButton:true});
//*************************//controlsvar yp = 10;var lbCaption = winObj.add("statictext",[10, yp, 10+420, yp+20],scriptName);yp+=30;var btnExec = winObj.add("button",[10, yp, 10+200, yp+25],"実行");var addStr = function(str,a){	var sep = "_";	if (str[str.length-1] === "_"){		sep = "";	}	return str + sep + a;}//*************************var addExp = function(srcComp,dstComp,layerIndex){	var sLayer = srcComp.layers[layerIndex];	var dLayer = dstComp.layers[layerIndex];	var exps = "comp(\"$1\").layer(\"$2\")";	exps = exps.replace("$1",srcComp.name);	exps = exps.replace("$2",sLayer.name);		try{		if (sLayer instanceof LightLayer)		{			dLayer.transform.position.expression = exps + ".transform.position";		}else if(sLayer instanceof CameraLayer)		{			dLayer.transform.pointOfInterest.expression = exps + ".transform.pointOfInterest";			dLayer.transform.position.expression = exps + ".transform.position";			dLayer.transform.orientation.expression = exps + ".transform.orientation";			dLayer.transform.xRotation.expression = exps + ".transform.xRotation";			dLayer.transform.yRotation.expression = exps + ".transform.yRotation";			dLayer.transform.zRotation.expression = exps + ".transform.zRotation";			dLayer.cameraOption.zoom.expression = exps + ".cameraOption.zoom";		}else{			dLayer.transform.anchorPoint.expression = exps + ".transform.anchorPoint";			dLayer.transform.position.expression = exps + ".transform.position";			dLayer.transform.scale.expression = exps + ".transform.scale";			dLayer.transform.opacity.expression = exps + ".transform.opacity";			if (dLayer.threeDLayer == true){				dLayer.transform.orientation.expression = exps + ".transform.orientation";				dLayer.transform.xRotation.expression = exps + ".transform.xRotation";				dLayer.transform.yRotation.expression = exps + ".transform.yRotation";				dLayer.transform.zRotation.expression = exps + ".transform.zRotation";			}else{				dLayer.transform.rotation.expression = exps + ".transform.rotation";			}		}	}catch(e)	{		alert("Error! " + dLayer.name);	}	}//*************************var exec = function(){	var ac = app.project.activeItem;	if ( (ac instanceof CompItem)==false) {		alert("Comp no Actived!");		return;	}	var srcComp = ac;	if (srcComp.numLayers<=0) {		alert(" no layer!");		return;	}	var cnt = 0;	if (app.project.numItems>1)	{		for ( var i=1; i<=app.project.numItems; i++)		{			if (app.project.items[i].name === srcComp.name)			{				cnt++;			}		}	}	if (cnt>=2) {		alert("対象のコンポと同じ名前のものがあります！");		return;	}				app.beginUndoGroup(scriptName);		var dstComp = ac.duplicate();	dstComp.name = addStr(srcComp.name ,"Exp");	if( srcComp.numLayers>0) {		for ( var i=1; i<=srcComp.numLayers; i++)		{			addExp(srcComp,dstComp,i);		}	}		app.endUndoGroup();	}btnExec.onClick = exec;//*************************//*************************//window show	if ( ( me instanceof Panel) == false){
		winObj.center(); 
		winObj.show();
	}})(this);